<!DOCTYPE html>
<html lang="{{ language.language_code }}" class="min-h-full">
{% from 'partials/_toggle_switch.html' import toggle_switch %}
{% include 'partials/_dark_mode_init.html' %}

<head>
    {% include 'partials/_base_head.html' %}

    {# Page-specific SEO meta tags #}
    {% set title = "Play Wordle in " ~ language.config.name ~ " â€” Free Daily Word Game (" ~ language.config.name_native ~ ")" %}
    {% set seo_tail = "Free unlimited word puzzle in 65+ languages." %}
    {% if language.config.name|lower == language.config.name_native|lower %}
        {% set seo_prefix = "Play Wordle in " ~ language.config.name ~ " â€” " %}
    {% else %}
        {% set seo_prefix = "Play Wordle in " ~ language.config.name ~ " (" ~ language.config.name_native ~ ") â€” " %}
    {% endif %}
    {% set native_desc = language.config.meta.description %}
    {% set full_desc = seo_prefix ~ native_desc ~ " " ~ seo_tail %}
    {% if full_desc|length > 160 %}
        {# Use first sentence only to keep under 160 chars #}
        {% set first_sentence = native_desc.split('. ')[0] %}
        {% if not first_sentence.endswith(('.', '!', '?', ':', 'Ö‰')) %}
            {% set first_sentence = first_sentence ~ "." %}
        {% endif %}
        {% set description = seo_prefix ~ first_sentence ~ " " ~ seo_tail %}
    {% else %}
        {% set description = full_desc %}
    {% endif %}
    <title>{{ title }}</title>
    <meta name="description" content="{{ description }}">
    <meta property="description" content="{{ description }}">
    <meta name="keywords" content="wordle, {{ language.config.name }}, {{ language.config.name_native }}">
    <meta property="og:title" content="{{ title }}">
    <meta property="og:url" content="https://wordle.global/{{ language.config.language_code }}">
    <meta property="og:type" content="website">
    <meta property="og:description" content="{{ description }}">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="wordle.global">
    <meta property="twitter:url" content="https://wordle.global/{{ language.config.language_code }}">
    <meta property="twitter:title" content="{{ title }}">
    <meta property="twitter:description" content="{{ description }}">

    <link rel="canonical" href="https://wordle.global/{{ language.config.language_code }}">
    {% include 'partials/_hreflang.html' %}

    <!-- Preconnect for faster loading -->
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>

    <!-- load backend variables (on window for ES module access) -->
    <script>
        window.word_list = JSON.parse('{{language.word_list | tojson | safe}}');
        window.word_list_supplement = JSON.parse('{{language.word_list_supplement | tojson | safe}}');
        console.log('\nFor the language: ' + '"{{language.config.name_native}}/{{language.config.name}}"' + ' there are:\n' + window.word_list.length + ' words in the word list\n' + window.word_list_supplement.length + ' words in the supplemental word list.');
        window.characters = JSON.parse('{{language.characters | tojson | safe}}');
        window.config = JSON.parse('{{language.config | tojson | safe}}');
        console.log("Character Set: " + window.characters);
        window.todays_idx = "{{ language.todays_idx }}";
        window.todays_word = "{{ language.daily_word }}";
        window.timezone_offset = {{ language.timezone_offset | default(0) | tojson }};
        console.log("Today's word is: " + window.todays_word.toUpperCase() + "\nDon't cheat!");
    </script>
</head>

<body class="min-h-[100dvh] h-[100dvh] overflow-hidden overscroll-none bg-white dark:bg-neutral-900 text-black dark:text-white transition-colors">
    {% include 'partials/_loading_skeleton.html' %}

    <div id="app" class="min-h-[100dvh] h-[100dvh]" style="display: none;">
        <div class="min-h-[100dvh] h-[100dvh]">
            <div class="wrapper container mx-auto flex flex-col h-full w-full max-w-lg safe-area-inset">
                <!-- The Header -->
                <header
                    class="relative flex flex-row justify-between items-center h-[50px] my-auto p-1 px-3 lg:px-1 border-b border-neutral-300 dark:border-neutral-600">
                    <button class="z-40 text-neutral-500" aria-label="instructions"
                        v-on:click="showHelpModal = !showHelpModal">
                        <svg xmlns="http://www.w3.org/2000/svg" class="text-neutral-500" width="24" height="24"
                            viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                            <circle cx="12" cy="12" r="9"></circle>
                            <line x1="12" y1="8" x2="12.01" y2="8"></line>
                            <polyline points="11 12 12 12 12 16 13 16"></polyline>
                        </svg>
                    </button>
                    <div class="absolute text-center right-0 left-0">
                        <h1 class="uppercase font-bold text-2xl sm:text-4xl tracking-wider"><a href="/">Wordle <span
                                    class="text-xl sm:text-xl bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded px-1 py-0">
                                    {{ language.config.language_code }}</span></a></h1>
                    </div>
                    <div class="flex flex-row gap-3 z-30">
                        <button class="m-0 sm:my-1" v-on:click="show_stats_modal = !show_stats_modal">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-neutral-500" width="24"
                                height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <rect x="3" y="12" width="6" height="8" rx="1"></rect>
                                <rect x="9" y="8" width="6" height="12" rx="1"></rect>
                                <rect x="15" y="4" width="6" height="16" rx="1"></rect>
                                <line x1="4" y1="20" x2="18" y2="20"></line>
                            </svg>
                        </button>
                        <button class="m-0 sm:my-1" v-on:click="show_options_modal = !show_options_modal">
                            <svg xmlns="http://www.w3.org/2000/svg" class="text-neutral-500" width="24" height="24"
                                viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path
                                    d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z">
                                </path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </button>
                    </div>
                </header>
                <!-- The game board -->
                <main class="flex flex-auto justify-center items-center">
                    <div
                        class="grid grid-rows-6 relative w-full h-full max-w-[350px] max-h-[420px] gap-1 p-3 box-border">
                        {% for i in range(6) %}
                        <div class="grid grid-cols-5 gap-1 w-full">
                            {% for j in range(5) %}
                            <div class="w-full h-full justify-center items-center inline-flex "
                                v-html="[[ tiles_visual[{{i}}][{{j}}] ]]"
                                v-bind:class="[[ tile_classes_visual[{{i}}][{{j}}] ]]">
                            </div>
                            {% endfor %}
                        </div>
                        {% endfor %}
                    </div>
                </main>
                <!-- The keyboard -->
                <div class="flex flex-col container mx-auto gap-2 w-full max-w-lg pb-2 md:pb-5 px-2">
                    {% for row in language.keyboard %}
                    <div class="flex gap-1">
                        {% for c in row %}
                        {% set hint = language.key_diacritic_hints.get(c.lower(), {}) %}
                        {% set hint_text = hint.text if hint else '' %}
                        {% set hint_above = hint.above if hint else false %}
                        <button class="flex-1 rounded uppercase text-sm font-bold p-1 sm:p-2 h-14 key{% if hint_text %} has-hint{% endif %}{% if hint_above %} hint-above{% endif %}"
                            data-char="{{ c }}" aria-label="{{ c }}{% if hint_text %} (also matches {{ hint_text }}){% endif %}" v-on:click="keyClick('{{ c }}')"
                            v-bind:class="[[ key_classes['{{ c }}'] ]]">
                            {% if hint_above and hint_text %}<span class="key-hint">{{ hint_text }}</span>{% endif %}
                            <span class="key-main">{{ c }}</span>
                            {% if not hint_above and hint_text %}<span class="key-hint">{{ hint_text }}</span>{% endif %}
                        </button>
                        {% endfor %}
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- NOTIFICATIONS & MODALS-->
        <div class="container mx-auto flex w-full max-w-lg justify-center items-center overflow z-1" v-cloak>
            {% set modals = "showHelpModal || show_stats_modal || show_options_modal" %}
            {% include 'partials/_modal_backdrop.html' %}

            <!-- help modal -->
            <!-- <div v-if="showHelpModal" class="opacity-25 fixed top-0 left-0 w-full h-full z-1 bg-black"></div> -->
            <div id="HelpModal" v-show="showHelpModal"
                class="fixed top-10 left-0 w-full h-full z-50 items-center flex mx-auto " v-cloak>
                <div class="bg-white dark:bg-neutral-800 rounded-lg shadow-lg p-5 m-4 border-2 border-slate-200 dark:border-neutral-600 mx-auto w-full max-w-md sm:max-w-lg"
                    v-cloak>
                    <div class="flex flex-col gap-2 relative">

                        <button type="button" v-on:click="showHelpModal = false" aria-label="Close" class="absolute top-0 right-0 p-1 ml-auto z-50">
                            <span class="leading-[0.25] h-5 w-5 text-3xl text-neutral-400 block outline-none focus:outline-none">Ã—</span>
                        </button>
                        <h2 class="flex mx-auto uppercase font-bold text-2xl tracking-wider">Wordle <span
                                class="ml-1 text-transparent bg-clip-text bg-gradient-to-r from-cyan-500 to-blue-500">{{
                                language.config.name_native }}</span>
                        </h2>

                        <h3 class="font-bold text-lg">{{ language.config.help.title }}</h3>
                        <!-- how to play -->
                        <p class="text-sm">{{ language.config.help.text_1_1_1 }} <a
                                class="font-bold uppercase">Wordle</a> {{ language.config.help.text_1_1_2 }}</p>
                        <p class="text-sm">{{ language.config.help.text_1_2 }}</p>
                        <p class="text-sm">{{ language.config.help.text_1_3 }}</p>

                        <div class="border-t-2 border-gray-300 dark:border-gray-600"></div>
                        <div class="justify-center items-center flex flex-col gap-2">
                            <h2 class="text-md font-semibold text-gray-900 dark:text-gray-100">{{ language.config.help.title_2 }}</h2>

                            <div class="grid grid-cols-5 gap-1 w-full max-w-xs">
                                {% for c in language.word_list[0] %}
                                {% if loop.index == 1 %}
                                <div
                                    class="w-full h-full inline-flex justify-center items-center correct text-2xl tiny:text-4xl uppercase font-bold select-none text-white">
                                    {{c}}</div>
                                {% else %}
                                <div
                                    class="w-full h-full inline-flex aspect-square justify-center items-center text-2xl tiny:text-4xl uppercase font-bold select-none border-2 border-neutral-500">
                                    {{c}}</div>
                                {% endif %}
                                {% endfor %}
                            </div>
                            <p class="text-sm mb-2"><span
                                    class="font-bold uppercase">{{language.word_list[0][0]}}</span> {{
                                language.config.help.text_2_1 }}</p>
                            <!-- w-full h-full inline-flex justify-center items-center incorrect text-2xl tiny:text-4xl uppercase font-bold select-none text-white -->

                            <div class="grid grid-cols-5 gap-1 w-full max-w-xs">
                                {% for c in language.word_list[1] %}
                                {% if loop.index == 3 %}
                                <div
                                    class="w-full h-full inline-flex justify-center items-center semicorrect text-2xl tiny:text-4xl uppercase font-bold select-none text-white">
                                    {{c}}</div>
                                {% else %}
                                <div
                                    class="w-full h-full inline-flex aspect-square justify-center items-center text-2xl tiny:text-4xl uppercase font-bold select-none border-2 border-neutral-500">
                                    {{c}}</div>
                                {% endif %}
                                {% endfor %}
                            </div>
                            <p class="text-sm mb-2"><span
                                    class="font-bold uppercase">{{language.word_list[1][2]}}</span> {{
                                language.config.help.text_2_2 }}</p>

                            <div class="grid grid-cols-5 gap-1 w-full max-w-xs">
                                {% for c in language.word_list[2] %}
                                {% if loop.index == 5 %}
                                <div
                                    class="w-full h-full inline-flex justify-center items-center incorrect text-2xl tiny:text-4xl uppercase font-bold select-none text-white">
                                    {{c}}</div>
                                {% else %}
                                <div
                                    class="w-full h-full inline-flex aspect-square justify-center items-center text-2xl tiny:text-4xl uppercase font-bold select-none border-2 border-neutral-500">
                                    {{c}}</div>
                                {% endif %}
                                {% endfor %}
                            </div>
                            <p class="text-sm mb-2"><span
                                    class="font-bold uppercase">{{language.word_list[2][4]}}</span> {{
                                language.config.help.text_2_3 }}</p>
                        </div>

                        <div class="border-t-2 border-gray-300 dark:border-gray-600"></div>

                        <div class="flex flex-col gap-2 py-2">
                            <a href="https://github.com/Hugo0/wordle/issues"
                               target="_blank"
                               rel="noopener noreferrer"
                               class="flex items-center gap-2 text-sm text-neutral-600 dark:text-neutral-300 hover:text-neutral-900 dark:hover:text-white">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path>
                                </svg>
                                {{ language.config.ui.report_issue or "Report an Issue" }}
                            </a>
                            <a href="https://github.com/Hugo0/wordle"
                               target="_blank"
                               rel="noopener noreferrer"
                               class="flex items-center gap-2 text-sm text-neutral-600 dark:text-neutral-300 hover:text-neutral-900 dark:hover:text-white">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                    <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"></path>
                                    <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"></path>
                                </svg>
                                {{ language.config.ui.view_source or "View Source Code" }}
                            </a>
                        </div>

                        <div class="border-t-2 border-gray-300 dark:border-gray-600"></div>

                        <button class="uppercase font-bold text-sm tracking-wider"
                            v-on:click="showHelpModal = !showHelpModal">{{ language.config.help.close }}
                            <span class="text-lg text-neutral-400">Ã—</span></button>
                    </div>
                </div>
            </div>

            <!-- options modal -->
            <div v-show="show_options_modal" class="fixed top-10 left-0 w-full h-full z-30 items-center mx-auto flex
            " v-cloak>
                <div class="bg-white dark:bg-neutral-800 rounded-lg shadow-lg p-5 m-4 border-2 border-slate-200 dark:border-neutral-600 mx-auto w-full max-w-xs sm:max-w-md"
                    v-cloak>
                    <div class="flex flex-col gap-2 relative">
                        <button type="button" v-on:click="show_options_modal = false" aria-label="Close" class="absolute top-0 right-0 p-1 ml-auto z-50">
                            <span class="leading-[0.25] h-5 w-5 text-3xl text-neutral-400 block outline-none focus:outline-none">Ã—</span>
                        </button>
                        <h3 class="uppercase font-bold text-xl tracking-wider mb-5">{{ language.config.ui.settings or "Settings" }}</h3>
                        <div class=" space-y-4">
                            <!-- Dark mode toggle -->
                            <div class="flex flex-row items-center">
                                <div class="flex-grow">
                                    <p>{{ language.config.ui.dark_mode or "Dark Mode" }}</p>
                                </div>
                                {{ toggle_switch('darkMode', 'toggleDarkMode()', language.config.ui.dark_mode or 'Dark Mode') }}
                            </div>

                            <div class="border-t-2 border-gray-300 dark:border-gray-600"></div>
                            <!-- Sound & Haptics (combined) -->
                            <div class="flex flex-row items-center">
                                <div class="flex-grow">
                                    <p>{{ language.config.ui.sound_and_haptics or "Sound & Haptics" }}</p>
                                </div>
                                {{ toggle_switch('feedbackEnabled', 'toggleFeedback()', language.config.ui.sound_and_haptics or 'Sound & Haptics') }}
                            </div>

                            <div class="border-t-2 border-gray-300 dark:border-gray-600"></div>
                            <!-- Word Info: definitions + AI art (combined) -->
                            <div class="flex flex-row items-center">
                                <div class="flex-grow">
                                    <p>{{ language.config.ui.word_info or "Word Info" }}</p>
                                    <p class="text-xs text-neutral-500 dark:text-neutral-400">{{ language.config.ui.word_info_desc or "Definition & AI art after game" }}</p>
                                </div>
                                {{ toggle_switch('wordInfoEnabled', 'toggleWordInfo()', language.config.ui.word_info or 'Word Info') }}
                            </div>

                            <div class="border-t-2 border-gray-300 dark:border-gray-600"></div>
                            <!-- toggle button for right_to_left -->
                            <div class="flex flex-row">
                                <p class="flex-grow">{{ language.config.ui.right_to_left or "Right to left" }}</p>
                                <!-- toggle at the end -->
                                <div class="flex flex-row items-center">
                                    <label for="right_to_left" class="flex items-center ml-2 animate-bounce">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="text-neutral-500 mr-4" width="24"
                                            height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                                            fill="none" stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                            <path
                                                d="M12 15v3.586a1 1 0 0 1 -1.707 .707l-6.586 -6.586a1 1 0 0 1 0 -1.414l6.586 -6.586a1 1 0 0 1 1.707 .707v3.586h3v6h-3z">
                                            </path>
                                            <path d="M21 15v-6"></path>
                                            <path d="M18 15v-6"></path>
                                        </svg>
                                    </label>
                                    <input type="checkbox" id="right_to_left" v-model="right_to_left" />
                                </div>
                                <div class="flex-row gap-2">
                                    <button class="font-bold text-sm tracking-wider"
                                        v-on:click="right_to_left = !right_to_left">[[ config?.right_to_left_on
                                        ]]</button>
                                </div>
                            </div>

                            {% if language.keyboard_layouts|length > 1 %}
                            <div class="border-t-2 border-gray-300 dark:border-gray-600"></div>
                            <form method="get" class="flex flex-row items-center"
                                aria-label="Keyboard layout selector">
                                <p id="keyboard-layout-label" class="flex-grow">{{ language.config.ui.keyboard_layout or "Keyboard layout" }}</p>
                                <select id="keyboard-layout-select" name="layout" aria-labelledby="keyboard-layout-label"
                                    class="border border-neutral-300 dark:border-neutral-600 rounded px-2 py-1 bg-white dark:bg-neutral-700 dark:text-white"
                                    onchange="this.form.submit()">
                                    {% for layout_name, layout_meta in language.keyboard_layouts.items() %}
                                    <option value="{{ layout_name }}"
                                        {% if layout_name == language.keyboard_layout_name %}selected{% endif %}>
                                        {{ layout_meta.label }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </form>
                            {% endif %}

                            <div class="border-t-2 border-gray-300 dark:border-gray-600"></div>
                            <div class="flex flex-row">
                                <p class="flex-grow">{{ language.config.ui.easy_mode or "Allow any word" }} (<span class="italic">{{ language.config.ui.easy_mode_label or "easy mode" }}</span>)</p>
                                <!-- toggle at the end -->
                                <input type="checkbox" v-model="allow_any_word" />
                            </div>


                            <!-- Install App button (only shown when not already installed) -->
                            <div v-if="canInstallPwa()" class="border-t-2 border-gray-300 dark:border-gray-600 mt-2 pt-4">
                                <button @click="installPwa()"
                                    class="w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-500 hover:bg-green-600 text-white font-medium rounded-lg">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                        <path d="M12 18h-7a2 2 0 0 1 -2 -2v-10a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v7.5"></path>
                                        <path d="M16 19h6"></path>
                                        <path d="M19 16v6"></path>
                                    </svg>
                                    {{ language.config.ui.install_app or "Install App" }}
                                </button>
                                <p class="text-xs text-center text-neutral-500 dark:text-neutral-400 mt-1">{{ language.config.ui.install_app_desc or "Play offline & get app icon" }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- stats modal -->
        <div v-show="show_stats_modal" class="fixed top-10 left-0 w-full h-full z-50 items-center flex" v-cloak>
            <div class="relative mx-auto w-full max-w-lg z-50 border-2 border-slate-200 dark:border-neutral-600 rounded-xl max-h-[85vh] overflow-y-auto" v-cloak>
                <div
                    class="border-0 rounded-lg drop-shadow-xl relative flex flex-col w-full bg-white dark:bg-neutral-800 outline-none focus:outline-none">

                    <div class="flex-initial relative mx-5 mt-5 z-50">
                        <h3 class="flex-auto text-center text-xl font-bold">Wordle {{
                            language.config.name_native }}
                            #[[ todays_idx ]] [[attempts]]/6
                        </h3>
                        <button type="button" v-on:click="show_stats_modal = false" aria-label="Close" class="absolute top-0 right-0 p-1 ml-auto z-50">
                            <span class="leading-[0.25] h-5 w-5 text-3xl text-neutral-400 block outline-none focus:outline-none">Ã—</span>
                        </button>
                    </div>

                    <!-- Tab buttons -->
                    <div class="flex mx-5 mt-2 border-b border-gray-200 dark:border-gray-600" role="tablist">
                        <button v-on:click="statsTab = 'today'" role="tab"
                            :aria-selected="statsTab === 'today'"
                            class="flex-1 py-2 text-xs font-medium transition-colors border-b-2"
                            :class="statsTab === 'today'
                                ? 'text-neutral-900 dark:text-white border-neutral-800 dark:border-neutral-200'
                                : 'text-neutral-500 dark:text-neutral-400 border-transparent hover:text-neutral-700 dark:hover:text-neutral-300'">
                            {{ language.config.ui.today or "Today" }}
                        </button>
                        <button v-on:click="statsTab = 'stats'" role="tab"
                            :aria-selected="statsTab === 'stats'"
                            class="flex-1 py-2 text-xs font-medium transition-colors border-b-2"
                            :class="statsTab === 'stats'
                                ? 'text-neutral-900 dark:text-white border-neutral-800 dark:border-neutral-200'
                                : 'text-neutral-500 dark:text-neutral-400 border-transparent hover:text-neutral-700 dark:hover:text-neutral-300'">
                            {{ language.config.ui.statistics or "Stats" }}
                        </button>
                        <button v-on:click="statsTab = 'global'" role="tab"
                            :aria-selected="statsTab === 'global'"
                            class="flex-1 py-2 text-xs font-medium transition-colors border-b-2"
                            :class="statsTab === 'global'
                                ? 'text-neutral-900 dark:text-white border-neutral-800 dark:border-neutral-200'
                                : 'text-neutral-500 dark:text-neutral-400 border-transparent hover:text-neutral-700 dark:hover:text-neutral-300'">
                            {{ language.config.ui.all_languages or "All Languages" }}
                        </button>
                    </div>

                    <!-- TODAY tab: word, definition, image, share, timer -->
                    <div v-show="statsTab === 'today'">
                        <!-- Today's word heading -->
                        <div v-if="game_over" class="px-6 pt-3 pb-1 text-center">
                            <a :href="'/' + config.language_code + '/word/' + todays_idx"
                                class="inline-block group">
                                <p class="text-lg font-bold tracking-widest uppercase text-neutral-800 dark:text-neutral-100 group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors">
                                    [[ todays_word ]]
                                </p>
                            </a>
                        </div>

                        <!-- Percentile badge (appears async after stats submission) -->
                        <div v-if="communityPercentile !== null" class="px-6 pb-1 text-center">
                            <a :href="communityStatsLink"
                                class="inline-flex items-center gap-1 text-sm text-green-600 dark:text-green-400 hover:underline">
                                {{ language.config.ui.better_than or "Better than" }} [[ communityPercentile ]]% {{ language.config.ui.of_players or "of players" }}
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"/>
                                    <path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"/>
                                </svg>
                            </a>
                        </div>

                        <!-- Definition Card (shown after game completion) -->
                        <div id="definition-card" class="px-6 pb-2" style="display: none;"></div>

                        <!-- Word Art Image (shown after game completion, if enabled) -->
                        <div id="word-image-card" class="px-6 pt-1 pb-2" style="display: none;"></div>

                        <!-- Share button -->
                        <div class="px-6 py-3 border-t border-gray-200 dark:border-gray-600">
                            <button
                                class="w-full py-2 px-4 text-white font-semibold rounded-lg shadow-lg transition-all duration-200"
                                :class="shareButtonState === 'success' ? 'bg-emerald-600 scale-105' : 'bg-green-500 hover:bg-green-600 active:bg-green-700'"
                                v-on:click="shareResults">
                                <span v-if="shareButtonState === 'success'">âœ“ {{ language.config.text.copied or 'Copied!' }}</span>
                                <span v-else>{{ language.config.text.share }}</span>
                            </button>
                        </div>

                        <!-- Next word countdown -->
                        <div class="flex flex-col items-center py-2 px-6 border-t border-gray-200 dark:border-gray-600">
                            <p class="uppercase font-semibold text-xs text-neutral-500 dark:text-neutral-400">{{
                                language.config.text.next_word }}</p>
                            <p class="text-2xl font-bold" v-html="time_until_next_day"></p>
                        </div>
                    </div>

                    <!-- STATS tab: distribution, language stats, emoji board + share -->
                    <div v-show="statsTab === 'stats'">
                        <!-- Guess Distribution Graph -->
                        <div class="px-6 py-3">
                            <h4 class="text-xs font-semibold uppercase tracking-wide mb-1 text-center text-neutral-500 dark:text-neutral-400">{{ language.config.ui.guess_distribution or "Guess Distribution" }}</h4>
                            <div class="space-y-0.5">
                                <div v-for="n in 6" :key="n" class="flex items-center gap-1.5">
                                    <span class="w-3 text-xs font-medium">[[ n ]]</span>
                                    <div class="flex-1 h-4 bg-gray-100 dark:bg-neutral-700 rounded-sm overflow-hidden">
                                        <div
                                            class="h-full flex items-center justify-end px-1 text-[10px] font-bold text-white transition-all duration-300"
                                            :class="isCurrentGuess(n) ? 'bg-green-500' : 'bg-gray-400 dark:bg-gray-500'"
                                            :style="{ width: getDistributionBarWidth(n) + '%' }">
                                            <span v-if="stats.guessDistribution">[[ stats.guessDistribution[n] ]]</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Language stats grid -->
                        <div class="px-4 py-3 border-t border-gray-200 dark:border-gray-600">
                            <div class="grid grid-cols-4 gap-1">
                                <div class="text-center">
                                    <p class="text-xl font-bold">[[stats.n_games]]</p>
                                    <p class="text-[10px] text-neutral-500 dark:text-neutral-400">{{ language.config.ui.games or "Games" }}</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-xl font-bold">[[Math.round(stats.win_percentage)]]%</p>
                                    <p class="text-[10px] text-neutral-500 dark:text-neutral-400">{{ language.config.ui.win_percent or "Win %" }}</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-xl font-bold"><span v-if="stats.current_streak > 0">ðŸ”¥</span>[[stats.current_streak]]</p>
                                    <p class="text-[10px] text-neutral-500 dark:text-neutral-400">{{ language.config.ui.streak or "Streak" }}</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-xl font-bold">[[stats.longest_streak]]</p>
                                    <p class="text-[10px] text-neutral-500 dark:text-neutral-400">{{ language.config.ui.best or "Best" }}</p>
                                </div>
                            </div>
                        </div>

                        <!-- Emoji board -->
                        <div class="relative flex-auto mx-6 my-3 pt-3 border-t border-gray-200 dark:border-gray-600">
                            <p class="text-md text-center whitespace-pre-line" id="emoji_board" v-html="emoji_board">
                            </p>
                            <p v-if="attempts=='0'" class="text-center text-sm text-gray-600 dark:text-gray-400">
                                {{ language.config.text.no_attempts }}
                            </p>
                        </div>

                        <!-- Share button -->
                        <div class="px-6 pb-3">
                            <button
                                class="w-full py-2 px-4 text-white font-semibold rounded-lg shadow-lg transition-all duration-200"
                                :class="shareButtonState === 'success' ? 'bg-emerald-600 scale-105' : 'bg-green-500 hover:bg-green-600 active:bg-green-700'"
                                v-on:click="shareResults">
                                <span v-if="shareButtonState === 'success'">âœ“ {{ language.config.text.copied or 'Copied!' }}</span>
                                <span v-else>{{ language.config.text.share }}</span>
                            </button>
                        </div>
                    </div>

                    <!-- GLOBAL tab: all languages stats -->
                    <div v-show="statsTab === 'global'">
                        <div class="px-4 py-3">
                            <!-- Summary grid -->
                            <div class="grid grid-cols-4 gap-1 mb-2">
                                <div class="text-center">
                                    <p class="text-xl font-bold">[[total_stats.total_games]]</p>
                                    <p class="text-[10px] text-neutral-500 dark:text-neutral-400">{{ language.config.ui.games or "Games" }}</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-xl font-bold">[[Math.round(total_stats.total_win_percentage)]]%</p>
                                    <p class="text-[10px] text-neutral-500 dark:text-neutral-400">{{ language.config.ui.win_percent or "Win %" }}</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-xl font-bold"><span v-if="total_stats.current_overall_streak > 0">ðŸ”¥</span>[[total_stats.current_overall_streak]]</p>
                                    <p class="text-[10px] text-neutral-500 dark:text-neutral-400">{{ language.config.ui.streak or "Streak" }}</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-xl font-bold">[[total_stats.languages_won?.length || 0]]</p>
                                    <p class="text-[10px] text-neutral-500 dark:text-neutral-400">{{ language.config.ui.languages or "Languages" }}</p>
                                </div>
                            </div>

                            <!-- Per-language breakdown -->
                            <div v-if="Object.keys(total_stats.game_stats || {}).length > 0" class="max-h-32 overflow-y-auto border-t border-neutral-200 dark:border-neutral-600 pt-1">
                                <div v-for="(langStats, code) in total_stats.game_stats" :key="code"
                                    class="flex items-center justify-between py-1 text-xs">
                                    <span class="font-medium">[[getLanguageName(code)]]</span>
                                    <span class="text-neutral-500 dark:text-neutral-400">
                                        [[langStats.n_games]] Â· [[Math.round(langStats.win_percentage)]]%
                                        <span v-if="langStats.current_streak > 0" class="text-orange-500 ml-1">ðŸ”¥[[langStats.current_streak]]</span>
                                    </span>
                                </div>
                            </div>
                            <p v-else class="text-xs text-neutral-500 dark:text-neutral-400 text-center pt-1 border-t border-neutral-200 dark:border-neutral-600">
                                {{ language.config.ui.play_more_languages or "Play more languages to see your global stats!" }}
                            </p>
                        </div>
                    </div>

                </div>
            </div>
        </div>


        <!-- alert that floats slowly down from top and closes after 3 seconds -->
        <div v-if="notification.show"
            class="fixed top-0 inset-x-0 mx-auto z-50 max-w-xs justify-items-center text-center" v-cloak>
            <div class="top-50 bg-black p-4 m-4 rounded-lg shadow-lg animate-pulse" v-cloak
                v-bind:style="{'top': notification.top + 'px'}">
                <p class="font-bold text-white">[[ notification.message ]]</p>
            </div>
        </div>
    </div>
    <!-- /app -->

    <!-- Simple banner to trigger the install dialog -->
    <div id="pwa-install-banner" class="pwa-install-banner" style="display: none;">
        <div style="flex: 1;">
            <strong>{{ language.config.ui.add_to_home or "Add to Home Screen" }}</strong>
            <div style="font-size: 13px; opacity: 0.9;">{{ language.config.ui.play_daily_like_app or "Play Wordle daily like an app" }}</div>
        </div>
        <button onclick="triggerPwaInstall()">{{ language.config.ui.install or "Install" }}</button>
        <button class="dismiss" onclick="dismissPwaInstall()">&times;</button>
    </div>

    {% set pwa_description = "Play Wordle in " ~ language.config.name_native %}
    {% include 'partials/_pwa_install.html' %}

    <!-- Vite-built JS (includes Vue, game logic, PWA) -->
    <script type="module" src="{{ vite_assets.js }}"></script>
</body>

</html>
